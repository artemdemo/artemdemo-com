<!DOCTYPE html><html lang="en"><head><title>Adding react-snap to my app | Artem Demo</title><link rel="icon" type="image/x-icon" href="/./assets/favicon-dec32dcbac.ico"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="description" content="Blog about web development, indie GameDev"><meta property="og:title" content="Adding react-snap to my app"><meta property="og:description" content="Blog about web development, indie GameDev"><link rel="stylesheet" href="/./assets/code-theme-36bdf5f7fe.css"><link rel="stylesheet" href="/./assets/site.render-5d1535d9c3.css"><script async src="https://www.googletagmanager.com/gtag/js?id=G-3BCNZ31TWL"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3BCNZ31TWL');</script></head><body><link rel="preload" as="image" href="react-snap-unexpected-token-error.png"><div><div class="header-wrapper"><div class="container"><div class="header-container"><div class="header-item header-item__logo"><a class="header-logo-link" href="/">Artem Demo &lt;/&gt;</a></div><div class="header-item header-item__menu"><div class="header-item-menu"><div class="top-menu"><div class="top-menu_item top-menu_item__active"><a class="top-menu_link" href="/">Blog</a></div><div class="top-menu_item"><a class="top-menu_link" href="/about/">About</a></div><div class="top-menu_item"><a class="top-menu_link" href="/contact/">Contact me</a></div></div></div></div></div><div class="header-separator"></div></div></div><div class="container"><div class="ContentWrapper"><h1>Adding react-snap to my app</h1><div class="secondary-text">17 October, 2020</div><div class="secondary-text">Tags:Â <a class="post-tags-item" href="/blog/tag/react-snap/">react-snap</a><a class="post-tags-item" href="/blog/tag/prerender/">prerender</a><a class="post-tags-item" href="/blog/tag/imgreview/">imgreview</a></div><p>I started to experiment with <a href="https://github.com/stereobooster/react-snap">react-snap</a> - a nice tool for creating pre rendered html of your SPA. The reason is fairly simple - I want to increase visibility of <a href="https://artemdemo.github.io/imgreview/">ImgReview</a> by search engines.</p><p>The installation is very easy. Basically you need to install the package npm install react-snap, and then just change your app render point to:</p><pre><code class="language-js hljs"><span class="hljs"><span class="hljs-keyword">const</span> rootElement = doc.<span class="hljs-title function_">getElementById</span>(&#x27;app&#x27;);

<span class="hljs-keyword">if</span> (rootElement.<span class="hljs-title function_">hasChildNodes</span>()) {
  <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">hydrate</span>(&lt;<span class="hljs-title class_">App</span> /&gt;, rootElement);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(&lt;<span class="hljs-title class_">App</span> /&gt;, rootElement);
}
</span></code></pre><p>In my case though there was a problem. Pre render failed with this weird error message:</p><pre><code class="hljs"><span class="hljs">pageerror at /: <span class="hljs-title class_">SyntaxError</span>: <span class="hljs-title class_">Unexpected</span> token &#x27;&lt;&#x27;
</span></code></pre><p><img src="react-snap-unexpected-token-error.png" alt="React snap unexpected token error"></p><p>Which wasn&#x27;t informative for me, since I had no idea what exactly is causing it (at first). And then it hit me - this is an error from the browser. It&#x27;s just loading wrong files, because it&#x27;s not using correct <code class="hljs"><span class="hljs">index.html</span></code> file.</p><p>React-snap is running headless chrome under the hood, this is how it creates pre rendered html. When there is an error during it, the only place to show it is in your terminal. So you need to look at it as you&#x27;re checking debug tools of Chrome.</p><p>So the problem was with the <code class="hljs"><span class="hljs">index.html</span></code> file of the app. In my case I&#x27;m placing it outside of the <code class="hljs"><span class="hljs">/build</span></code> folder, so I need somehow to change the source folder for react-snap. It took sometime to figure out the right configuration, since they don&#x27;t have good documentation, but eventually I found the solution:</p><pre><code class="hljs"><span class="hljs"><span class="hljs-comment">// package.json</span>

&quot;reactSnap&quot; : {
    &quot;source&quot; : &quot;./&quot;
},
</span></code></pre><p>The cool part about &quot;react-snap&quot; is that it doesn&#x27;t need much configuration. Even if you use routing, it&#x27;s not a problem - all your routes will be rendered into html.</p></div></div></div></body></html>