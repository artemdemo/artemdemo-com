<!DOCTYPE html><html lang="en"><head><title>2D explosion wave in unity | Artem Demo</title><link rel="icon" type="image/x-icon" href="/./assets/favicon-dec32dcbac.ico"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="description" content="Blog about web development, indie GameDev"><meta property="og:title" content="2D explosion wave in unity"><meta property="og:description" content="Blog about web development, indie GameDev"><link rel="stylesheet" href="/./assets/code-theme-36bdf5f7fe.css"><link rel="stylesheet" href="/./assets/site.render-5d1535d9c3.css"><script async src="https://www.googletagmanager.com/gtag/js?id=G-3BCNZ31TWL"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3BCNZ31TWL');</script></head><body><link rel="preload" as="image" href="explosion-render-line.png"><div><div class="header-wrapper"><div class="container"><div class="header-container"><div class="header-item header-item__logo"><a class="header-logo-link" href="/">Artem Demo &lt;/&gt;</a></div><div class="header-item header-item__menu"><div class="header-item-menu"><div class="top-menu"><div class="top-menu_item top-menu_item__active"><a class="top-menu_link" href="/">Blog</a></div><div class="top-menu_item"><a class="top-menu_link" href="/about/">About</a></div><div class="top-menu_item"><a class="top-menu_link" href="/contact/">Contact me</a></div></div></div></div></div><div class="header-separator"></div></div></div><div class="container"><div class="ContentWrapper"><h1>2D explosion wave in unity</h1><div class="secondary-text">04 February, 2021</div><div class="secondary-text">Tags:Â <a class="post-tags-item" href="/blog/tag/unity/">unity</a></div><p>One of the challenging issues with in-game explosions - is to decide how you&#x27;ll deal damage to the player. First, it should be an area damage and regardless of the player&#x27;s position he should receive damage (if he stays close enough).</p><p>Without the damage - explosion is only a cool visual effect, but there aren&#x27;t many emotions attached to it. It looks interesting, but it&#x27;s not frightening:</p><video autoplay="" loop="" data-test="foo"><source src="explosion-without-damage.mp4" type="video/mp4"></video><p>There are four aspects in a successful explosion:</p><ol><li>It should go &quot;BOOM&quot; visually.</li><li>It should damage a careless player that stays too close to the epicenter.</li><li>Optionally it can show an explosion wave, so the player will learn what is the safe distance.</li><li>It should sound like an explosion.</li></ol><p>In this post I will deal with the first 3.</p><p>First of all I need somehow to render a circle around the exploded object. For that can be used the &quot;Line Render&quot; component. All &quot;Line Render&quot; configurations I&#x27;m doing in code, the only thing I defined in the UI was Material. I changed it to &quot;Default-Line&quot;.</p><p><img src="explosion-render-line.png" alt="Explosion Render Line"></p><p>Next is to draw a growing circle around the game object. This is how I did it:</p><pre><code class="language-typescript hljs"><span class="hljs"><span class="hljs-keyword">private</span> float _currentRadius;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> int <span class="hljs-title class_">Segments</span> = <span class="hljs-number">36</span>;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> float <span class="hljs-title class_">LineWidth</span> = <span class="hljs-number">0.</span>015f;

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title class_">Start</span>() {
  _lr = <span class="hljs-title class_">GetComponent</span>&lt;<span class="hljs-title class_">LineRenderer</span>&gt;();

  <span class="hljs-title class_">SetupExplosionWave</span>();
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title class_">FixedUpdate</span>() {
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">IsDestroyed</span>()) {
    <span class="hljs-comment">// I&#x27;m just increasing damage radius.</span>
    <span class="hljs-comment">// It will stop when object will be destroyed.</span>
    _currentRadius += 8f * <span class="hljs-title class_">Time</span>.<span class="hljs-property">deltaTime</span>;
    <span class="hljs-title class_">DrawExplosionWave</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">IsPlayerInTheRadius</span>()) {
      <span class="hljs-comment">// Here is the logic to deal damage to the player</span>
    }
  }
}

<span class="hljs-keyword">private</span> bool <span class="hljs-title class_">IsPlayerInTheRadius</span>() {
  <span class="hljs-keyword">var</span> results = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Collider2D</span>[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> size = <span class="hljs-title class_">Physics2D</span>.<span class="hljs-title class_">OverlapCircleNonAlloc</span>(
    transform.<span class="hljs-property">position</span>,
    _currentRadius,
    results,
    <span class="hljs-title class_">LayerMask</span>.<span class="hljs-title class_">GetMask</span>(<span class="hljs-title class_">ELayers</span>.<span class="hljs-property">Player</span>.<span class="hljs-title class_">ToString</span>(&quot;g&quot;))
  );
  <span class="hljs-keyword">return</span> size &gt; <span class="hljs-number">0</span>;
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title class_">SetupExplosionWave</span>() {
  <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnimationCurve</span>();
  curve.<span class="hljs-title class_">AddKey</span>(<span class="hljs-number">0.</span>0f, <span class="hljs-title class_">LineWidth</span>);
  _lr.<span class="hljs-property">widthCurve</span> = curve;

  <span class="hljs-keyword">var</span> waveColor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Color</span>(1f, 1f, 1f, <span class="hljs-number">0.</span>35f);

  _lr.<span class="hljs-property">startColor</span> = waveColor;
  _lr.<span class="hljs-property">endColor</span> = waveColor;
}

<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title class_">DrawExplosionWave</span>() {
  <span class="hljs-keyword">var</span> points = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>[<span class="hljs-title class_">Segments</span> + <span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> position = transform.<span class="hljs-property">position</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-title class_">Segments</span>; i++) {
    <span class="hljs-keyword">var</span> angle = ((float)i / (float)<span class="hljs-title class_">Segments</span>) * <span class="hljs-number">360</span> * <span class="hljs-title class_">Mathf</span>.<span class="hljs-property">Deg2Rad</span>;
    <span class="hljs-keyword">var</span> x = <span class="hljs-title class_">Mathf</span>.<span class="hljs-title class_">Sin</span>(angle) * _currentRadius + position.<span class="hljs-property">x</span>;
    <span class="hljs-keyword">var</span> y = <span class="hljs-title class_">Mathf</span>.<span class="hljs-title class_">Cos</span>(angle) * _currentRadius + position.<span class="hljs-property">y</span>;
    points[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector3</span>(x, y, <span class="hljs-number">0</span>);
  }

  points[<span class="hljs-title class_">Segments</span>] = points[<span class="hljs-number">0</span>];
  _lr.<span class="hljs-property">positionCount</span> = points.<span class="hljs-property">Length</span>;
  _lr.<span class="hljs-title class_">SetPositions</span>(points);
}
</span></code></pre><p>The final result:</p><video autoplay="" loop=""><source src="explosion-with-damage-wave.mp4" type="video/mp4"></video></div></div></div></body></html>