<!DOCTYPE html><html lang="en"><head><title>Custom logger for the Frontend application | Artem Demo</title><link rel="icon" type="image/x-icon" href="/./assets/favicon-dec32dcbac.ico"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="description" content="Blog about web development, indie GameDev"><meta property="og:title" content="Custom logger for the Frontend application"><meta property="og:description" content="Blog about web development, indie GameDev"><link rel="stylesheet" href="/./assets/code-theme-36bdf5f7fe.css"><link rel="stylesheet" href="/./assets/site.render-5d1535d9c3.css"><script async src="https://www.googletagmanager.com/gtag/js?id=G-3BCNZ31TWL"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3BCNZ31TWL');</script></head><body><div><div class="header-wrapper"><div class="container"><div class="header-container"><div class="header-item header-item__logo"><a class="header-logo-link" href="/">Artem Demo &lt;/&gt;</a></div><div class="header-item header-item__menu"><div class="header-item-menu"><div class="top-menu"><div class="top-menu_item top-menu_item__active"><a class="top-menu_link" href="/">Blog</a></div><div class="top-menu_item"><a class="top-menu_link" href="/about/">About</a></div><div class="top-menu_item"><a class="top-menu_link" href="/contact/">Contact me</a></div></div></div></div></div><div class="header-separator"></div></div></div><div class="container"><div class="ContentWrapper"><h1>Custom logger for the Frontend application</h1><div class="secondary-text">03 March, 2019</div><div class="secondary-text">Tags:Â <a class="post-tags-item" href="/blog/tag/logger/">logger</a><a class="post-tags-item" href="/blog/tag/console/">console</a></div><p>Let&#x27;s talk for a moment about logging in the FrontEnd application. Yes, we can use standard <code class="hljs"><span class="hljs"><span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span></span></code> or any other <code class="hljs"><span class="hljs"><span class="hljs-variable language_">console</span>[method]</span></code> that is available to us, but what we really want to have is some way to have a log available, when it&#x27;s allowed and to hide the logging, when we&#x27;re not interested in it. So let&#x27;s review this.</p><p>Here are the required features:</p><ul><li>Should be based on a standard <code class="hljs"><span class="hljs"><span class="hljs-variable language_">console</span></span></code> object.</li><li>Should show 3 methods: <code class="hljs"><span class="hljs"><span class="hljs-built_in">log</span></span></code>, <code class="hljs"><span class="hljs">warn</span></code>, <code class="hljs"><span class="hljs"><span class="hljs-type">error</span></span></code> - behind the scenes they should use methods from the standard <code class="hljs"><span class="hljs"><span class="hljs-variable language_">console</span></span></code> object.</li><li>For each log message it should print the actual browser time in the format <code class="hljs"><span class="hljs">&#x27;MM-DD HH:mm:ss&#x27;</span></code>.</li><li>Log in browsers console should show the actual line where it was used by the user.</li><li>A user should be able to disable it:<ul><li>By setting the <code class="hljs"><span class="hljs">LOGGER</span></code> variable in <code class="hljs"><span class="hljs"><span class="hljs-variable language_">localStorage</span></span></code> to <code class="hljs"><span class="hljs"><span class="hljs-literal">false</span></span></code>.</li><li>It&#x27;s must be enough to check whether logging is disabled only once, at the start of the program. No need to perform it on each log.</li></ul></li></ul><p>Actually, this problem has 3 features that make it a very good candidate for a whiteboard question during the interview. These features are:</p><ul><li>The resultant code is short, it will not take a long time to write.</li><li>It has real-world usage and is not some abstract question regarding a problem that doesn&#x27;t exist.</li><li>And it addresses some language aspects that are not widely used but are very interesting and critical in certain use-cases.</li></ul><p>Let&#x27;s talk about these aspects.</p><p>First, we need to create a separate file, that will provide the API of our library. At least it should expose 3 methods: log, warn and error. The simplest way to do it will be the following:</p><pre><code class="language-javascript hljs"><span class="hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> log = <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> warn = <span class="hljs-variable language_">console</span>.<span class="hljs-property">warn</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> error = <span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>);
</span></code></pre><p>This approach will allow us to use methods from our library but get all the benefits of the system&#x27;s <code class="hljs"><span class="hljs"><span class="hljs-variable language_">console</span></span></code> object. The browser will print the line of usage in the code and not from our library. Now we need to somehow prevent logging if it is not allowed.</p><p>First, let&#x27;s create a function that will check whether log can be displayed or not:</p><pre><code class="language-javascript hljs"><span class="hljs"><span class="hljs-keyword">const</span> showLog = () =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LOGGER</span> = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(&#x27;<span class="hljs-variable constant_">LOGGER</span>&#x27;);
  <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">LOGGER</span> === &#x27;<span class="hljs-literal">true</span>&#x27;;
};
</span></code></pre><p>Now we need to utilize this function. If we allow the use of logging we will pass it to our public methods. In the case where we do not allow - we will pass an empty function.</p><pre><code class="language-javascript hljs"><span class="hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> log = <span class="hljs-title function_">showLog</span>() ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>) : () =&gt; {};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> warn = <span class="hljs-title function_">showLog</span>() ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">warn</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>) : () =&gt; {};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> error = <span class="hljs-title function_">showLog</span>() ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>) : () =&gt; {};
</span></code></pre><p>Empty function is a good solution in this case since it allows us not to care about how the user will use our methods. A user doesn&#x27;t need to check whether public methods can or can&#x27;t be used.</p><p>Now, the most interesting part. How to print the time on each usage. Let&#x27;s do it in reverse order. If we already have some variable that has a timestamp value, we could do it in the following way:</p><pre><code class="language-javascript hljs"><span class="hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> log = <span class="hljs-title function_">showLog</span>()
  ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>, getTime)
  : () =&gt; {};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> warn = <span class="hljs-title function_">showLog</span>()
  ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">warn</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>, getTime)
  : () =&gt; {};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> error = <span class="hljs-title function_">showLog</span>()
  ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>, getTime)
  : () =&gt; {};
</span></code></pre><p>In the example above <code class="hljs"><span class="hljs">getTime</span></code> should provide a timestamp each time one of the methods was called. But it means that <code class="hljs"><span class="hljs">getTime</span></code> should be some kind of function and this looks weird since <code class="hljs"><span class="hljs"><span class="hljs-variable language_">console</span>[method]</span></code> doesn&#x27;t accept callbacks. It will try to print each variable that has been provided, and here is the hint, when we provide a function to the <code class="hljs"><span class="hljs"><span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span></span></code>, then the whole function body will be printed - it means that the built-in method <code class="hljs"><span class="hljs">toString</span></code> has been called. What is interesting is that we can override this method:</p><pre><code class="language-javascript hljs"><span class="hljs"><span class="hljs-keyword">const</span> getTime = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {};
getTime.<span class="hljs-property">toString</span> = () =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`[<span class="hljs-subst">${moment(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).format(&#x27;MM-DD HH:mm:ss&#x27;)}</span>]`</span>;
};
</span></code></pre><p>The whole code will look like this:</p><pre><code class="language-javascript hljs"><span class="hljs"><span class="hljs-comment">/* eslint-disable no-console, prefer-spread */</span>
<span class="hljs-keyword">import</span> moment <span class="hljs-keyword">from</span> &#x27;moment&#x27;;

<span class="hljs-keyword">const</span> showLog = () =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LOGGER</span> = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(&#x27;<span class="hljs-variable constant_">LOGGER</span>&#x27;);
  <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">LOGGER</span> === &#x27;<span class="hljs-literal">true</span>&#x27;;
};

<span class="hljs-keyword">const</span> getTime = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {};
getTime.<span class="hljs-property">toString</span> = () =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`[<span class="hljs-subst">${moment(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).format(&#x27;MM-DD HH:mm:ss&#x27;)}</span>]`</span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> log = <span class="hljs-title function_">showLog</span>()
  ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>, getTime)
  : () =&gt; {};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> warn = <span class="hljs-title function_">showLog</span>()
  ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">warn</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>, getTime)
  : () =&gt; {};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> error = <span class="hljs-title function_">showLog</span>()
  ? <span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">console</span>, getTime)
  : () =&gt; {};
</span></code></pre></div></div></div></body></html>