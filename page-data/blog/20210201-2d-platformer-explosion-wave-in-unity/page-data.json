{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/blog/20210201-2d-platformer-explosion-wave-in-unity/","result":{"data":{"site":{"siteMetadata":{"title":"Artem Demo, indie developer","author":"Artem Demo"}},"markdownRemark":{"id":"356e838b-6c98-552e-80d7-4bca7aad2c9a","excerpt":"One of the challenging issues with in-game explosions - is to decide how you’ll deal damage to the player.\nFirst, it should be an area damage and regardless of the player’s position he should receive damage (if he stays close enough).","html":"<p>One of the challenging issues with in-game explosions - is to decide how you’ll deal damage to the player.\nFirst, it should be an area damage and regardless of the player’s position he should receive damage (if he stays close enough).</p>\n<!-- end -->\n<p>Without the damage - explosion is only a cool visual effect, but there aren’t many emotions attached to it.\nIt looks interesting, but it’s not frightening:</p>\n<video autoplay loop data-test=\"foo\">\n  <source src=\"/5d10784f77354fb9534567f8bfba435e/explosion-without-damage.mp4\" type=\"video/mp4\" />\n</video>\n<p>There are four aspects in a successful explosion:</p>\n<ol>\n<li>It should go “BOOM” visually.</li>\n<li>It should damage a careless player that stays too close to the epicenter.</li>\n<li>Optionally it can show an explosion wave, so the player will learn what is the safe distance.</li>\n<li>It should sound like an explosion.</li>\n</ol>\n<p>In this post I will deal with the first 3.</p>\n<p>First of all I need somehow to render a circle around the exploded object.\nFor that can be used the “Line Render” component.\nAll “Line Render” configurations I’m doing in code, the only thing I defined in the UI was Material.\nI changed it to “Default-Line”.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 458px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/19052ca653fb0eaed2777b2215a54f58/e9a79/explosion-render-line.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC5UlEQVRIx6WWy04yQRCF5y2MRhfGRLkNclGEYcBBUBRFjTFujM9gogsfQ1fyuPXXV9CTZhww+V0cpi9Vp6uqu08TJOOJJMORDAaJ3N7eyv39vdzc3Eiv15MoiqTb7Uq73Ta4fhZXV1cyHA6tHZycnMgqtFot6XQ66UJJksjx8bGRr7IPmOz3+3J6eroEnAGRjkYjOT8/t3EXFdH6YAzSII5jmUwmcnl5acDZN2w0GtJsNuXo6MiiIwocHTH+rk1wgavBxcVFOuinUa/XJQzDFJVKxcZYnFK8vLzI09OTBXV2diYB6Y7H46XidzwQHcRuLrXR2jLfXszRt5RdjQa6S01NqaGp+Wgu0PgFLAyClrKOteAtTae2vy+NQkHqPg4Olvs5wKdaLEpYrUpAsathVcJSSSo6+D8IFWW+GlRAmAVdoaiEa6EO6+YLkOuGGSHGJR9qkG0XXTtnrrRYMCUsl8vzCP6IpQj/gh8RZidcav5Y3riPJULfKQvKgeFvwK7KsWnqXV0VGdjd3ZXt7W3Dzs7OjzZfsLW1JXt7eypfUSyRXhsi5Y66E8/5rNVq8vz8LB8fH/L29ibv7+8Gv+362GAbxMlQL/lUksHA5AmFcXcTdcHh+/tbPj8/5evrKxfMzWYzeX191bus8oM4oB4oNW2nOJCS9sbGhmxubq4FNpTHxAH5gtBpm1MUtI+5u7u7VGRXgUAGmqUJLE4MAKKCCEJSnk6npnl8WRTbPFxfX5umGiEdN0GEpnULfYOYDfJFNg8cncPDwzmhvzLKy0oIL4TsuJP9dXAlCthZNoMoTWi1Dv4zMCdr/XB2WQD6HDlghJDxPri3NfuidbqxtGkvnCkBzjxggBtCunPF1ghwgsztFGVg9x2ifiJR3LPxSBfEERLA4YcDO3vo+eH9pWYra8W4ws27lN2X147FrIZE9Pj4aGkz4N7e7CvnI7sgPuk/B2r48PBghBxQdpoVs6R5u5p9XvH5B3xcvxaiK4YNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Explosion Render Line\"\n        title=\"Explosion Render Line\"\n        src=\"/static/19052ca653fb0eaed2777b2215a54f58/e9a79/explosion-render-line.png\"\n        srcset=\"/static/19052ca653fb0eaed2777b2215a54f58/3c361/explosion-render-line.png 148w,\n/static/19052ca653fb0eaed2777b2215a54f58/03654/explosion-render-line.png 295w,\n/static/19052ca653fb0eaed2777b2215a54f58/e9a79/explosion-render-line.png 458w\"\n        sizes=\"(max-width: 458px) 100vw, 458px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Next is to draw a growing circle around the game object. This is how I did it:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">private</span> float _currentRadius<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">const</span> int Segments <span class=\"token operator\">=</span> <span class=\"token number\">36</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">const</span> float LineWidth <span class=\"token operator\">=</span> <span class=\"token number\">0.015</span>f<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n  _lr <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">GetComponent</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>LineRenderer<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token function\">SetupExplosionWave</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">FixedUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">IsDestroyed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// I'm just increasing damage radius.</span>\n    <span class=\"token comment\">// It will stop when object will be destroyed.</span>\n    _currentRadius <span class=\"token operator\">+=</span> <span class=\"token number\">8</span>f <span class=\"token operator\">*</span> Time<span class=\"token punctuation\">.</span>deltaTime<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">DrawExplosionWave</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">IsPlayerInTheRadius</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Here is the logic to deal damage to the player</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> bool <span class=\"token function\">IsPlayerInTheRadius</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> results <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Collider2D</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> size <span class=\"token operator\">=</span> Physics2D<span class=\"token punctuation\">.</span><span class=\"token function\">OverlapCircleNonAlloc</span><span class=\"token punctuation\">(</span>\n    transform<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">,</span> \n    _currentRadius<span class=\"token punctuation\">,</span>\n    results<span class=\"token punctuation\">,</span>\n    LayerMask<span class=\"token punctuation\">.</span><span class=\"token function\">GetMask</span><span class=\"token punctuation\">(</span>ELayers<span class=\"token punctuation\">.</span>Player<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"g\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> size <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">SetupExplosionWave</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> curve <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AnimationCurve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  curve<span class=\"token punctuation\">.</span><span class=\"token function\">AddKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span>f<span class=\"token punctuation\">,</span> LineWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  _lr<span class=\"token punctuation\">.</span>widthCurve <span class=\"token operator\">=</span> curve<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> waveColor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Color</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>f<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>f<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>f<span class=\"token punctuation\">,</span> <span class=\"token number\">0.35</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  _lr<span class=\"token punctuation\">.</span>startColor <span class=\"token operator\">=</span> waveColor<span class=\"token punctuation\">;</span>\n  _lr<span class=\"token punctuation\">.</span>endColor <span class=\"token operator\">=</span> waveColor<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">DrawExplosionWave</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> points <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">[</span>Segments <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> position <span class=\"token operator\">=</span> transform<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> Segments<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> angle <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>float<span class=\"token punctuation\">)</span>i <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>float<span class=\"token punctuation\">)</span>Segments<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">360</span> <span class=\"token operator\">*</span> Mathf<span class=\"token punctuation\">.</span>Deg2Rad<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> x <span class=\"token operator\">=</span> Mathf<span class=\"token punctuation\">.</span><span class=\"token function\">Sin</span><span class=\"token punctuation\">(</span>angle<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> _currentRadius <span class=\"token operator\">+</span> position<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> y <span class=\"token operator\">=</span> Mathf<span class=\"token punctuation\">.</span><span class=\"token function\">Cos</span><span class=\"token punctuation\">(</span>angle<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> _currentRadius <span class=\"token operator\">+</span> position<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span>\n    points<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  points<span class=\"token punctuation\">[</span>Segments<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> points<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  _lr<span class=\"token punctuation\">.</span>positionCount <span class=\"token operator\">=</span> points<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span>\n  _lr<span class=\"token punctuation\">.</span><span class=\"token function\">SetPositions</span><span class=\"token punctuation\">(</span>points<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The final result:</p>\n<video autoplay loop>\n  <source src=\"/ff0817db6a574cabc7aaefe8fa8c7faf/explosion-with-damage-wave.mp4\" type=\"video/mp4\" />\n</video>","frontmatter":{"title":"2D explosion wave in unity","date":"February 04, 2021","tags":["unity","game"]}}},"pageContext":{"slug":"/20210201-2d-platformer-explosion-wave-in-unity/","previous":{"fields":{"slug":"/20210130-designing-games-book/"},"frontmatter":{"title":"Designing Games, book by Tynan Sylvester","tags":["book","studying","game"]}},"next":null}},"staticQueryHashes":[]}