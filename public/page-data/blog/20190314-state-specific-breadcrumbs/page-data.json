{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/blog/20190314-state-specific-breadcrumbs/","webpackCompilationHash":"75d0da1a0948445d1f69","result":{"data":{"site":{"siteMetadata":{"title":"Artem Demo, web dev.","author":"Artem Demo"}},"markdownRemark":{"id":"ccee8545-dc18-5c43-9d55-6cff01bf838d","excerpt":"Breadcrumbs can be displayed in different ways. Usually, this is solved in a naive way - if a user enters the page where a certain product is displayed, then he will see breadcrumbs from categories that are hierarchically dependent on each other. This is reasonably easy to implement because it is static information. The more complex requirement is to display a history of the changes, where we’ll see not only the previous pages but also the filters that have been applied to them.","html":"<p>Breadcrumbs can be displayed in different ways. Usually, this is solved in a naive way - if a user enters the page where a certain product is displayed, then he will see breadcrumbs from categories that are hierarchically dependent on each other. This is reasonably easy to implement because it is static information. The more complex requirement is to display a history of the changes, where we’ll see not only the previous pages but also the filters that have been applied to them.</p>\n<!-- end -->\n<p>Let’s start by defining a use-case. It will be a simple one, as we don’t need to make it complicated. I’m building an application that is dealing with some kinds of deliveries. There are “parcels”, that have packages and items. They are dependent on each other and they can be presented in the following way:</p>\n<ol>\n<li>\n<p>Parcels</p>\n<ul>\n<li>Parcels: delivered</li>\n</ul>\n</li>\n<li>Single parcel</li>\n<li>Package</li>\n<li>\n<p>List of items</p>\n<ul>\n<li>List of items: red</li>\n</ul>\n</li>\n<li>Single item</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7c3319275b126b5cb3277dc7161477e2/6da3e/breadcrumbs-sequence.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.361111111111112%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAUUlEQVQI12O4e/euz61bt/Ju3ryZDqSLbt++bXH//n0rIF1448aNNKB84Z07d/QfPnzoBKQLgGIZQHVZDx48AKmXvnfvXvT169ezgepzgWp8AVAoOoGIUY8KAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Breadcrumbs sequence\"\n        title=\"Breadcrumbs sequence\"\n        src=\"/static/7c3319275b126b5cb3277dc7161477e2/b9e4f/breadcrumbs-sequence.png\"\n        srcset=\"/static/7c3319275b126b5cb3277dc7161477e2/cf440/breadcrumbs-sequence.png 148w,\n/static/7c3319275b126b5cb3277dc7161477e2/d2d38/breadcrumbs-sequence.png 295w,\n/static/7c3319275b126b5cb3277dc7161477e2/b9e4f/breadcrumbs-sequence.png 590w,\n/static/7c3319275b126b5cb3277dc7161477e2/6da3e/breadcrumbs-sequence.png 720w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>As you can see from the list, the parcels and items can be sorted. Packages are presented in a simple list and you just need to find the right one.</p>\n<p>Now, we need to define functionality for our breadcrumbs that will define whether we implement them or not. So the requirements are:</p>\n<ol>\n<li>Breadcrumbs list should be activated when the user enters a page that allows breadcrumbs.</li>\n<li>If the user enters a page with no breadcrumbs, then the breadcrumbs data should be lost.</li>\n<li>\n<p>Each crumb should also display filters that have been applied on the list that the user saw on the previous page.</p>\n<ul>\n<li>The user should be able to click on the breadcrumb and go back to the page with the same filtered (or sorted) list.</li>\n</ul>\n</li>\n<li>The user should be able to send a link to the current page, with breadcrumbs, to a coworker and he will see exactly the same breadcrumbs history.</li>\n</ol>\n<p><strong>Routing structure</strong></p>\n<p>Ok, let’s start by defining the routings that will be used for displaying our pages. Each one of the entities has its own page and can be accessed independently, so routing needs to reflect this. This is a fairly easy part since it’s relying on the basic functionality of any routing:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>Router history<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>history<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">'/'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>AppView<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>IndexRoute component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>MainView<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">'parcels'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>ParcelsView<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">'parcels/:parcelId'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>SingleParcelView<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">'packages'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>PackagesView<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">'packages/:packageId'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>SinglePackageView<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">'items'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>ItemsView<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">'items/:itemId'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>SingleItemView<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Route<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Router<span class=\"token operator\">></span></code></pre></div>\n<p>As you can see above I’m assuming there are already defined views and that I can incorporate them into my router. I will define each one of them later. First, let’s see what will be the template for each view. It will be something simple, but nevertheless, let’s first define it. At the top, we’ll have a menu that is permanently placed there. Under the menu is a placeholder for breadcrumbs - they could be shown or not, it depends on the page. After that, we have page content.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 261px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6fa2dc5ef7397105a9d7a44b2c4d6b99/48fa3/page-structure.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.89655172413795%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAACLklEQVQ4y81US2sTURS+/iShG8GFpatuFao2reI/UlduXIkzq27ctBSySdLMDIQkhrzfCenk/X44M5mZ43cupBQpsSkFvfBxzp177neec0U+n38/GAyo2WzScDikyWRCy+WSVqvVvTGfz4lXJpMJCNM034bDYVIUZQVpRaNRu9/v2yC2x+PxvTCdTpdMjOCORCqV+sDsvu9LeJ63MxzHkRHmcrlTgYj2oHwpFoufgM8PQalU+giOr4ZhPBWPtJ7caNls9rDX6/1EzTTUwgB06PpoNDJY8p71TqdjwE5n2e12pc6S96j5VbvdTiPafYFL79AdCoVCFI/HCWFTIpHgelA6naZIJEIwpPV6TZZl3QluCK96vX4kWq3WCTxxyymZTBIiJtREolKpyH25XKbFYkGz2exOICifG9poNF4JeH+JkNH9cQswgWvMo8lAqiaM5R6pmXB8zfJPHek3MX5zOD4USOk5Ijmr1WrfARVhKwwcqoVCQWFgvlQ4VhC1Asm6utFxrsL2G0r0Q9O0ZwIb+acgXJkayKSOqLfW7Tb4z+IF8gATBrheYHfQGDcYDHq6rnv45qHDHtL1kPpWoEyWbdvcyNcCnQywF1x2UXj/VqEJxgTjrWAb2DqcDQjfSEJuOw5dHPpssMHmwv9F+LcU/wnhMT+Q/K7hcA25E/gOCH9xYzddlu8he3Bdd+e3kO/wyNy8h3gMDqrVagjDfIGhvnwIcPcc86zFYrEX4rHXb3LAWCg3wzXDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Page structure\"\n        title=\"Page structure\"\n        src=\"/static/6fa2dc5ef7397105a9d7a44b2c4d6b99/48fa3/page-structure.png\"\n        srcset=\"/static/6fa2dc5ef7397105a9d7a44b2c4d6b99/cf440/page-structure.png 148w,\n/static/6fa2dc5ef7397105a9d7a44b2c4d6b99/48fa3/page-structure.png 261w\"\n        sizes=\"(max-width: 261px) 100vw, 261px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><strong>Passing breadcrumbs between views</strong></p>\n<p>The next problem will be how to pass breadcrumbs between views. We need a unified strategy for that. There should be only one service that has this logic and it will only need to provide a clear API.</p>\n<p>First, the whole logic will be based on the history object that can receive path and query params in order to create a URL for the next view. I will piggyback on this functionality, but I can’t use it as is, because before being able to use it, we need to wrap it in our service logic:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9de4373bfd095e5e9387a2ba73030be8/be18a/history-wrapper.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.833836858006045%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB9klEQVQoz42SvWsacRjHf3oeRbiqaZIjbVJKKU2mTiEhkMWhHTrEDv0DujlkyNS5+0En6dAuWRppsC4Sh7gIB4ogBRV8O/HtfFd8qaUdHNR8n8M7DDSSBx6eu+f33Of3fJ/nWCaTOVMUxVMsFqVCofC1XC4fMBiimWIqldKjM5lMKul0OlapVJKqqh5RvlqtaueG4bA4m83m4/F4TtZqtU4p32w2HzQaDXOv1+PpPZfLfaDzyWSi1QF4QvlQKMTdArbb7e/D4VAZDAa/+v0+6tS37D+GjvdHo9E5Lvag9ht8j60yl8tlpQjpO+jsDTp1osvXkHQoSRKd2ZdcgG/yPP8YcQtO8Ql8zQDG43F+0ckXkoSu59PplKT9i0QiG4IgPBVF8ZXNZtt1OBwvLRbLC5STP184dSwyzIhFo1EGhomAWNKzWq3mymaz77Cs9+jyeEnII8CsgJk4jqNl0Df6UuiZY263myAE1LKQ+6lUKvmx8Yt8Pn8J6A+8XwP8E/Nepxq99k7DL2EU4cMgZM8B/A3/i+1S/IO8ij9im2pisZhpJdDv9xvAcDhs7Xa7D3GJLRAIiOhSxKIcXq/X7vP5NBAiu5cRVAdD3udOpzPGLKvY+ACzvlrMSVO00mRZNkBYCLeQ/hEewXyD9XpdxgUeHZhIJO5k3QCcw0xQfpB9ngAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"History wrapper\"\n        title=\"History wrapper\"\n        src=\"/static/9de4373bfd095e5e9387a2ba73030be8/b9e4f/history-wrapper.png\"\n        srcset=\"/static/9de4373bfd095e5e9387a2ba73030be8/cf440/history-wrapper.png 148w,\n/static/9de4373bfd095e5e9387a2ba73030be8/d2d38/history-wrapper.png 295w,\n/static/9de4373bfd095e5e9387a2ba73030be8/b9e4f/history-wrapper.png 590w,\n/static/9de4373bfd095e5e9387a2ba73030be8/be18a/history-wrapper.png 662w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The API of the history object is quite simple. In order to change the URL, we need to push its definition into history:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">history<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  pathname<span class=\"token punctuation\">:</span> <span class=\"token string\">'/some-url'</span><span class=\"token punctuation\">,</span>\n  search<span class=\"token punctuation\">:</span> <span class=\"token string\">'?query=list-of-breadcrumbs'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now we need to define how these breadcrumbs need to be stored in the URL. Since it will be a list of objects, the obvious choice will be JSON, but we need to encode it, in order to store it in the URL, and it could be a quite long string, which could create a problem in the future. Honestly, there is no easy workaround for this problem. What we can do for now is to convert the JSON string into the base64 format and gain some space; not much, but it’s better than nothing.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> _get <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash/get'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> _isString <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash/isString'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> history <span class=\"token keyword\">from</span> <span class=\"token string\">'../history'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> breadCrumbsSequence <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        path<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\/parcels$/</span><span class=\"token punctuation\">,</span>\n        defaultName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Parcels'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n        path<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\/parcels\\/[^/\\s]+$/</span><span class=\"token punctuation\">,</span>\n        defaultName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Single parcel'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n        path<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\/packages\\/[^/\\s]+$/</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// Here I'm disabling default name in order to test what will be shown instead</span>\n        <span class=\"token comment\">// (should be a path)</span>\n        <span class=\"token comment\">// defaultName: 'Single package',</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n        path<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\/items\\/[^/\\s]+$/</span><span class=\"token punctuation\">,</span>\n        defaultName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Single item'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">QUERY_CRUMB_PROP</span> <span class=\"token operator\">=</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">encodeCrumbs</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">crumbs</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">encodeURI</span><span class=\"token punctuation\">(</span><span class=\"token function\">btoa</span><span class=\"token punctuation\">(</span>crumbs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">decodeCrumbs</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">atob</span><span class=\"token punctuation\">(</span><span class=\"token function\">decodeURI</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getCrumbs</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> location <span class=\"token operator\">=</span> history<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentLocation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> queryData <span class=\"token operator\">=</span> <span class=\"token function\">_get</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">query.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">QUERY_CRUMB_PROP</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> decodedStr <span class=\"token operator\">=</span> queryData <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">decodeCrumbs</span><span class=\"token punctuation\">(</span>queryData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> crumbs <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        crumbs <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>decodedStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        crumbs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> crumbs<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/*\n * @param data {object}\n * @param data.pathname {string}\n * @param data.currentCrumbName {string}\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">historyPush</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> location <span class=\"token operator\">=</span> history<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentLocation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> crumbs <span class=\"token operator\">=</span> <span class=\"token function\">getCrumbs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> nextCrumb <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        p<span class=\"token punctuation\">:</span> location<span class=\"token punctuation\">.</span>pathname <span class=\"token operator\">+</span> location<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// If user provided crumb name we'll use it</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">_isString</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>currentCrumbName<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> data<span class=\"token punctuation\">.</span>currentCrumbName <span class=\"token operator\">!==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        nextCrumb<span class=\"token punctuation\">.</span>n <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>currentCrumbName<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> pathObj <span class=\"token operator\">=</span> breadCrumbsSequence<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">.</span>pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// If there is no name we'll use default name</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pathObj <span class=\"token operator\">&amp;&amp;</span> pathObj<span class=\"token punctuation\">.</span>defaultName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            nextCrumb<span class=\"token punctuation\">.</span>n <span class=\"token operator\">=</span> pathObj<span class=\"token punctuation\">.</span>defaultName<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pathObj<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// If there is no default name we'll use pathname</span>\n            nextCrumb<span class=\"token punctuation\">.</span>n <span class=\"token operator\">=</span> location<span class=\"token punctuation\">.</span>pathname<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    crumbs<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>nextCrumb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> str <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>crumbs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    history<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        pathname<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>pathname<span class=\"token punctuation\">,</span>\n        search<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">QUERY_CRUMB_PROP</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">encodeCrumbs</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Good, now we can store breadcrumbs in the URL and have access to them. The next step will be to define the way of displaying them. Since I have been using bootstrap CSS in almost every project, I will use design and CSS classes from there.</p>\n<p>This time the only thing we need to do is to fetch breadcrumbs from the URL, if there is something to display, then render it, and if an array is empty, then render nothing.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> _get <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash/get'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Link <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> getCrumbs <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../services/breadcrumbs'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Breadcrumbs</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>PureComponent</span> <span class=\"token punctuation\">{</span>\n    state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        crumbs<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> crumbs <span class=\"token operator\">=</span> <span class=\"token function\">getCrumbs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> crumbs <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">renderLastCrumb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">_get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">,</span> <span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n                <span class=\"token operator\">&lt;</span>li\n                    className<span class=\"token operator\">=</span><span class=\"token string\">'breadcrumb-item active'</span>\n                    aria<span class=\"token operator\">-</span>current<span class=\"token operator\">=</span><span class=\"token string\">'page'</span>\n                <span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span>\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> crumbs <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>crumbs<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>nav aria<span class=\"token operator\">-</span>label<span class=\"token operator\">=</span><span class=\"token string\">'breadcrumb'</span><span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span>ol className<span class=\"token operator\">=</span><span class=\"token string\">'breadcrumb'</span><span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">{</span>crumbs<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">crumb<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n                        <span class=\"token operator\">&lt;</span>li\n                            className<span class=\"token operator\">=</span><span class=\"token string\">'breadcrumb-item'</span>\n                            key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">crumb-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>index<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span>\n                        <span class=\"token operator\">></span>\n                            <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>crumb<span class=\"token punctuation\">.</span>p<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n                                <span class=\"token punctuation\">{</span>crumb<span class=\"token punctuation\">.</span>n<span class=\"token punctuation\">}</span>\n                            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderLastCrumb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ol<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>nav<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nBreadcrumbs<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    current<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        name<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nBreadcrumbs<span class=\"token punctuation\">.</span>defaultProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    current<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Breadcrumbs<span class=\"token punctuation\">;</span></code></pre></div>\n<p>This is it, all the major parts are here. The full example is stored in my GitHub and you can check it out <a href=\"https://github.com/artemdemo/breadcrumbs\">https://github.com/artemdemo/breadcrumbs</a></p>","frontmatter":{"title":"State-specific breadcrumbs","date":"March 14, 2019","tags":["breadcrumbs","browser history","routing"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/20190314-state-specific-breadcrumbs/","previous":{"fields":{"slug":"/20190308-catch-and-log-errors-in-NodeJS-app/"},"frontmatter":{"title":"Catch and log errors in NodeJS app","tags":["node.js","error handling"]}},"next":{"fields":{"slug":"/20190316-udemy-become-a-product-manager/"},"frontmatter":{"title":"Become a Product Manager [udemy]","tags":["udemy","product management","studying"]}}}}}